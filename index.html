<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Store Map</title>

<!-- Leaflet CSS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<!-- Playfair Display font -->
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600&display=swap" rel="stylesheet">

<style>
html, body {
  height: 100%;
  margin: 0;
  font-family: 'Playfair Display', serif;
}

#container {
  display: flex;
  height: 100vh;
}

/* Left panel */
#locations {
  width: 280px;
  background: #FFF6E0;
  color: #EBA35C;
  padding: 20px;
  box-sizing: border-box;
  overflow-y: auto;
}
.location-item {
  margin-bottom: 15px;
  cursor: pointer;
  transition: transform 0.1s;
}
.location-item:hover {
  transform: scale(1.05);
}
.location-item.active {
  font-weight: bold;
  text-decoration: underline;
}

/* Map styling */
#map {
  flex: 1;
  height: 100vh;
}

/* Orange circular markers */
.leaflet-marker-icon.circle-marker {
  border-radius: 50%;
  background-color: #EBA35C !important;
  width: 20px;
  height: 20px;
  margin-left: -10px;
  margin-top: -10px;
  border: 2px solid white;
}

/* Responsive: stack vertically on small screens */
@media (max-width: 768px) {
  #container {
    flex-direction: column;
  }
  #locations {
    width: 100%;
    height: auto;
    max-height: 200px;
    overflow-y: scroll;
  }
  #map {
    height: calc(100vh - 200px);
  }
}
</style>
</head>
<body>

<div id="container">
  <div id="locations">
    <div id="location-list"></div>
  </div>
  <div id="map"></div>
</div>

<script>
const stores = [
  { name: "O'Fiach's Irish Pub & Restaurant", lat: 51.02776844577999, lng: 4.481041039370103, address: "Grote Markt 24, 2800 Mechelen" },
  { name: "TÃ¸mmer Catering", lat: 51.06274749843587, lng: 4.6549262682076185, address: "Houwstraat 20, 2580 Putte" },
  { name: "Patrick Foley's Irish Pub and Restaurant", lat: 51.05057746413051, lng: 3.719207776150486, address: "Recollettenlei 10, 9000 Gent" },
  { name: "Delaney's Irish Pub", lat: 51.209686840929905, lng: 3.226991112393724, address: "Burg 8, 8000 Brugge" }
];

// Initialize map
const map = L.map('map');

// Greyscale base map (Carto Light)
L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
  attribution: '&copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> & <a href="https://carto.com/">CARTO</a>',
  subdomains: 'abcd',
  maxZoom: 19
}).addTo(map);

// Orange circle icon
const circleIcon = L.divIcon({ className: 'circle-marker' });
const markers = [];
const list = document.getElementById('location-list');

stores.forEach(store => {
  const marker = L.marker([store.lat, store.lng], { icon: circleIcon }).addTo(map);

  const mapsLink = `https://www.google.com/maps/search/?api=1&query=${store.lat},${store.lng}`;
  const popupContent = `
    <strong>${store.name}</strong><br>
    ${store.address}<br>
    <a href="${mapsLink}" target="_blank">Get Directions</a>
  `;
  marker.bindPopup(popupContent);
  markers.push(marker);

  const item = document.createElement('div');
  item.className = 'location-item';
  item.textContent = store.name;
  item.addEventListener('click', () => {
    map.setView([store.lat, store.lng], 14);
    marker.openPopup();
    document.querySelectorAll('.location-item').forEach(el => el.classList.remove('active'));
    item.classList.add('active');
  });
  list.appendChild(item);
});

// Fit map to all markers
const group = L.featureGroup(markers);
map.fitBounds(group.getBounds().pad(0.2));

// Ensure proper map display (GitHub/Cargo)
setTimeout(() => map.invalidateSize(), 500);
window.addEventListener('resize', () => map.invalidateSize());
</script>

</body>
</html>
